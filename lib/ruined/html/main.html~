<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html> <head>
 <meta http-equiv="content-type" content="text/html; charset=utf-8">
 <meta http-equiv="content-style-type" content="text/css">
 <title></title>
 <link rel="stylesheet" href="../css/smoothness/jquery-ui-1.8.5.custom.css"></link>
 <script type="text/javascript" src="../js/jquery-1.4.2.min.js"></script>
 <script type="text/javascript" src="../js/jquery-ui-1.8.5.custom.min.js"></script>
 <script type="text/javascript">
var files = new Object();
var priorLine = { line: null, index: null };
var interval = 5000;
function addFile(name, line, command) {
  var a = name.split('/');
  $('#tabs').tabs( "add" , '/debug/file/' + name , a[a.length - 1]);
  $('#tabs').tabs('option', 'cache', true);
  var index = $('#tabs').tabs('length') - 1;
  $('#tabs').tabs('select', index);
  return index;
}
function changeTab(index) {
  $('#tabs').tabs('select', index);
}
function lineColor(command) {
  if (command == 'cont') {
    return 'yellow';
  }
  return 'red';
}

function setLine(index, line, command) {
  if (line > 0) {
    --line;
  }
  if (priorLine.index != null) {
    $('#ui-tabs-' + (priorLine.index * 2 + 2) + ' > table > tbody > tr > td')[priorLine.line].style.backgroundColor = '';
  }
  $('#ui-tabs-' + (index * 2 + 2) + ' > table > tbody > tr > td')[line].style.backgroundColor = lineColor(command);
  priorLine.index = index;
  priorLine.line = line;
}
function stepProc(command) {
  $.get('/debug/' + command, function(data) {
    var o = eval('(' + data + ')');
    if (files[o.file] == null) {
      files[o.file] = addFile(o.file, o.line, command);
      setLine(files[o.file], o.line, command);
    } else {
      changeTab(files[o.file]);
      setLine(files[o.file], o.line, command);
    }
  });

}
function contProc(command) {
  stepProc(command);
  callNext(command);
}
function callNext(command) {
  setTimeout('contProc("' + command + '");', interval);
}
$(function() {
  $('#tabs').tabs({ajaxOptions: {async: false}});
  $('button', '.console').button();
  $('#run').click(function() {
    contProc('cont');
  });
  $('#step').click(function() {
    stepProc('cont');
  });
});
$(document).ready(function() {
  $('#waiting').ajaxError(function() {
    alert('error');
  });
  stepProc('stepping');
});
</script>
</head>

<body>
<div class='console'>
  <button id='run'>Run</button>
  <button id='step'>Step</button>
  <button id='break'>Break</button>
</div>

<div id="tabs">
  <ul></ul>
</div>

<hr>
<div id="waiting"></div>
<address></address>
<!-- hhmts start --> Last modified: Sat Oct 09 03:55:26 +0900 2010 <!-- hhmts end -->
</body> </html>
